<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>Tactics: More Basic Tactics</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="common/slides.js"></script>
<link href="common/css/slides.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 1: Logical Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Tactics<span class="subtitle">More Basic Tactics</span></h1>



<div class="doc">
<a name="lab139"></a><h1 class="section">The <span class="inlinecode"><span class="id" title="tactic">apply</span></span> Tactic</h1>

<div class="paragraph"> </div>

 We can use <span class="inlinecode"><span class="id" title="tactic">apply</span></span> when some hypothesis or an earlier
    lemma exactly matches the goal: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">silly1</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">n</span>;<span class="id" title="variable">o</span>] = [<span class="id" title="variable">n</span>;<span class="id" title="variable">p</span>] →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">n</span>;<span class="id" title="variable">o</span>] = [<span class="id" title="variable">m</span>;<span class="id" title="variable">p</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> <span class="id" title="variable">eq<sub>1</sub></span> <span class="id" title="variable">eq<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="variable">eq<sub>1</sub></span>.<br/>
</div>

<div class="doc">
Here, we could finish with "<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="variable">eq<sub>2</sub></span>.</span>  <span class="inlinecode"><span class="id" title="tactic">reflexivity</span>.</span>" as we
    have done several times before.  We can finish this proof in
    a single step by using the <span class="inlinecode"><span class="id" title="tactic">apply</span></span> tactic instead: 
</div>
<div class="code code-tight">

&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">eq<sub>2</sub></span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab140"></a><h3 class="section"> </h3>
 <span class="inlinecode"><span class="id" title="tactic">apply</span></span> also works with <i>conditional</i> hypotheses: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">silly2</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span> → [<span class="id" title="variable">n</span>;<span class="id" title="variable">o</span>] = [<span class="id" title="variable">m</span>;<span class="id" title="variable">p</span>]) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">n</span>;<span class="id" title="variable">o</span>] = [<span class="id" title="variable">m</span>;<span class="id" title="variable">p</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span> <span class="id" title="variable">eq<sub>1</sub></span> <span class="id" title="variable">eq<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">eq<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">eq<sub>1</sub></span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
</div>

<div class="doc">
<a name="lab143"></a><h1 class="section">The <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="keyword">with</span></span> Tactic</h1>

<div class="paragraph"> </div>

 The following silly example uses two rewrites in a row to
    get from <span class="inlinecode">[<span class="id" title="variable">a</span>;<span class="id" title="variable">b</span>]</span> to <span class="inlinecode">[<span class="id" title="variable">e</span>;<span class="id" title="variable">f</span>]</span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">trans_eq_example</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">e</span> <span class="id" title="variable">f</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">a</span>;<span class="id" title="variable">b</span>] = [<span class="id" title="variable">c</span>;<span class="id" title="variable">d</span>] →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">c</span>;<span class="id" title="variable">d</span>] = [<span class="id" title="variable">e</span>;<span class="id" title="variable">f</span>] →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">a</span>;<span class="id" title="variable">b</span>] = [<span class="id" title="variable">e</span>;<span class="id" title="variable">f</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">e</span> <span class="id" title="variable">f</span> <span class="id" title="variable">eq<sub>1</sub></span> <span class="id" title="variable">eq<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">eq<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">eq<sub>2</sub></span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab144"></a><h3 class="section"> </h3>
 Since this is a common pattern, we might like to pull it out
    as a lemma recording, once and for all, the fact that equality is
    transitive. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">trans_eq</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">X</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> : <span class="id" title="variable">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span> → <span class="id" title="variable">m</span> = <span class="id" title="variable">o</span> → <span class="id" title="variable">n</span> = <span class="id" title="variable">o</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">X</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">eq<sub>1</sub></span> <span class="id" title="variable">eq<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">eq<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">eq<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab145"></a><h3 class="section"> </h3>
 Applying this lemma to the example above requires a slight
    variation on <span class="inlinecode"><span class="id" title="tactic">apply</span></span>: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">trans_eq_example'</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">e</span> <span class="id" title="variable">f</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">a</span>;<span class="id" title="variable">b</span>] = [<span class="id" title="variable">c</span>;<span class="id" title="variable">d</span>] →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">c</span>;<span class="id" title="variable">d</span>] = [<span class="id" title="variable">e</span>;<span class="id" title="variable">f</span>] →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="variable">a</span>;<span class="id" title="variable">b</span>] = [<span class="id" title="variable">e</span>;<span class="id" title="variable">f</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">e</span> <span class="id" title="variable">f</span> <span class="id" title="variable">eq<sub>1</sub></span> <span class="id" title="variable">eq<sub>2</sub></span>.<br/>
</div>

<div class="doc">
Doing <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="variable">trans_eq</span></span> doesn't work!  But... 
</div>
<div class="code code-tight">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">trans_eq</span> <span class="id" title="keyword">with</span> (<span class="id" title="variable">m</span>:=[<span class="id" title="variable">c</span>;<span class="id" title="variable">d</span>]).<br/>
</div>

<div class="doc">
does. 
</div>
<div class="code code-tight">

&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">eq<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">eq<sub>2</sub></span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab146"></a><h1 class="section">The <span class="inlinecode"><span class="id" title="tactic">injection</span></span> and <span class="inlinecode"><span class="id" title="tactic">discriminate</span></span> Tactics</h1>

<div class="paragraph"> </div>

 In Coq, the constructors of inductive types are <i>injective</i>
    and <i>disjoint</i>.

<div class="paragraph"> </div>

    E.g., for <span class="inlinecode"><span class="id" title="variable">nat</span></span>...

<div class="paragraph"> </div>

<ul class="doclist">
<li> if <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> then it must hold that <span class="inlinecode"><span class="id" title="variable">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">m</span></span> (that is, <span class="inlinecode"><span class="id" title="variable">S</span></span> is
      <i>injective</i> aka <i>one-to-one</i>)

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="variable">O</span></span> is not equal to <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">n</span></span> for any <span class="inlinecode"><span class="id" title="variable">n</span></span> (that is, <span class="inlinecode"><span class="id" title="variable">O</span></span> and <span class="inlinecode"><span class="id" title="variable">S</span></span> are
      <i>disjoint</i>)

</li>
</ul>
 
<div class="paragraph"> </div>

 For example, we can prove the injectivity of <span class="inlinecode"><span class="id" title="variable">S</span></span> by using the
    <span class="inlinecode"><span class="id" title="variable">pred</span></span> function defined in <span class="inlinecode"><span class="id" title="variable">Basics.v</span></span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">S_injective</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">S</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">S</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="variable">H<sub>2</sub></span>: <span class="id" title="variable">n</span> = <span class="id" title="variable">pred</span> (<span class="id" title="variable">S</span> <span class="id" title="variable">n</span>)). { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H<sub>1</sub></span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab147"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 As a convenience, the <span class="inlinecode"><span class="id" title="tactic">injection</span></span> tactic allows us to
    exploit injectivity of any constructor. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">S_injective'</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">S</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">S</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">Hnm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">Hnm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Here's a more interesting example that shows how <span class="inlinecode"><span class="id" title="tactic">injection</span></span> can
    derive multiple equations at once. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">injection_ex<sub>1</sub></span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;[<span class="id" title="variable">n</span>; <span class="id" title="variable">m</span>] = [<span class="id" title="variable">o</span>; <span class="id" title="variable">o</span>] →<br/>
&nbsp;&nbsp;[<span class="id" title="variable">n</span>] = [<span class="id" title="variable">m</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">o</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">H<sub>1</sub></span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H<sub>2</sub></span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab148"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 The "<span class="inlinecode"><span class="id" title="keyword">as</span></span>" variant of <span class="inlinecode"><span class="id" title="tactic">injection</span></span> permits us to choose names for
    the equations and immediately introduce them as hypotheses, rather
    than as premises. The original equality, in this case <span class="inlinecode"><span class="id" title="variable">H</span></span>, is
    also removed from the hypotheses with this variant. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">injection_ex<sub>2</sub></span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;[<span class="id" title="variable">n</span>] = [<span class="id" title="variable">m</span>] →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="variable">H</span> <span class="id" title="keyword">as</span> <span class="id" title="variable">Hnm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">Hnm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab149"></a><h3 class="section"> </h3>

</div>
<div class="code code-space">

<br/>
</div>

<div class="doc">
So much for injectivity of constructors.  What about disjointness?

<div class="paragraph"> </div>

    The principle of disjointness says that two terms beginning with
    different constructors (like <span class="inlinecode"><span class="id" title="variable">O</span></span> and <span class="inlinecode"><span class="id" title="variable">S</span></span>, or <span class="inlinecode"><span class="id" title="variable">true</span></span> and <span class="inlinecode"><span class="id" title="variable">false</span></span>)
    can never be equal.  This means that, any time we find ourselves
    working in a context where we've <i>assumed</i> that two such terms are
    equal, we are justified in concluding anything we want to (because
    the assumption is nonsensical).

<div class="paragraph"> </div>

    The <span class="inlinecode"><span class="id" title="tactic">discriminate</span></span> tactic embodies this principle: It is used on a
    hypothesis involving an equality between different
    constructors (e.g., <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">O</span></span>), and it solves the current goal
    immediately.  For example: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">eqb_0_l</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span>,<br/>
&nbsp;&nbsp;&nbsp;0 =? <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span> → <span class="id" title="variable">n</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab150"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 This is an instance of a logical principle known as the <i>principle
    of explosion</i>, which asserts that a contradictory hypothesis
    entails anything, even false things! 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">discriminate_ex<sub>1</sub></span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">S</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">O</span> →<br/>
&nbsp;&nbsp;2 + 2 = 5.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">contra</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">contra</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">discriminate_ex<sub>2</sub></span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">false</span> = <span class="id" title="variable">true</span> →<br/>
&nbsp;&nbsp;[<span class="id" title="variable">n</span>] = [<span class="id" title="variable">m</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">contra</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">contra</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab151"></a><h3 class="section"> </h3>

</div>
<div class="code code-space">

<br/>
</div><div class="quiz"><div>
</div>

<div class="doc">
Suppose Coq's proof state looks like

<div class="paragraph"> </div>

<div class="code code-tight">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;<span class="id" title="variable">subgoals</span>,&nbsp;<span class="id" title="keyword">subgoal</span>&nbsp;1<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">x</span>&nbsp;:&nbsp;<span class="id" title="variable">bool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">y</span>&nbsp;:&nbsp;<span class="id" title="variable">bool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">H</span>&nbsp;:&nbsp;<span class="id" title="variable">negb</span>&nbsp;<span class="id" title="variable">x</span>&nbsp;=&nbsp;<span class="id" title="variable">negb</span>&nbsp;<span class="id" title="variable">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;============================<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">y</span>&nbsp;=&nbsp;<span class="id" title="variable">x</span>
<div class="paragraph"> </div>

</div>
    and we apply the tactic <span class="inlinecode"><span class="id" title="tactic">injection</span></span> <span class="inlinecode"><span class="id" title="variable">H</span></span>.  What will happen?

<div class="paragraph"> </div>

    (1) "No more subgoals."

<div class="paragraph"> </div>

    (2) The tactic fails.

<div class="paragraph"> </div>

    (3) None of the above.

</div>
<div class="code code-tight">
</div >

<br/>
</div>

<div class="doc">
<a name="lab152"></a><h3 class="section"> </h3>
 The injectivity of constructors allows us to reason that
    <span class="inlinecode"><span style='font-size:120%;'>&forall;</span></span> <span class="inlinecode">(<span class="id" title="variable">n</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="variable">nat</span>),</span> <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="variable">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">m</span></span>.  The converse of this
    implication is an instance of a more general fact about both
    constructors and functions, which we will find convenient in a few
    places below: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="tactic">f_equal</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">A</span> <span class="id" title="variable">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="variable">f</span>: <span class="id" title="variable">A</span> → <span class="id" title="variable">B</span>) (<span class="id" title="variable">x</span> <span class="id" title="variable">y</span>: <span class="id" title="variable">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">x</span> = <span class="id" title="variable">y</span> → <span class="id" title="variable">f</span> <span class="id" title="variable">x</span> = <span class="id" title="variable">f</span> <span class="id" title="variable">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">A</span> <span class="id" title="variable">B</span> <span class="id" title="variable">f</span> <span class="id" title="variable">x</span> <span class="id" title="variable">y</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">eq_implies_succ_equal</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span> → <span class="id" title="variable">S</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">S</span> <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Or use tactic <span class="inlinecode"><span class="id" title="tactic">f_equal</span></span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">eq_implies_succ_equal'</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span> → <span class="id" title="variable">S</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">S</span> <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab153"></a><h1 class="section">Using Tactics on Hypotheses</h1>

<div class="paragraph"> </div>

 Many tactics come with "<span class="inlinecode">...</span> <span class="inlinecode"><span class="id" title="keyword">in</span></span> <span class="inlinecode">...</span>" variants that work on
    hypotheses instead of goals. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">S_inj</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> <span class="id" title="variable">m</span> : <span class="id" title="variable">nat</span>) (<span class="id" title="variable">b</span> : <span class="id" title="variable">bool</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="variable">S</span> <span class="id" title="variable">n</span>) =? (<span class="id" title="variable">S</span> <span class="id" title="variable">m</span>) = <span class="id" title="variable">b</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> =? <span class="id" title="variable">m</span> = <span class="id" title="variable">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">b</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab154"></a><h3 class="section"> </h3>
 The ordinary <span class="inlinecode"><span class="id" title="tactic">apply</span></span> tactic is a form of "backward
    reasoning": it says "We're trying to prove <span class="inlinecode"><span class="id" title="variable">X</span></span> and we know
    <span class="inlinecode"><span class="id" title="variable">Y</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="variable">X</span></span>, so if we can prove <span class="inlinecode"><span class="id" title="variable">Y</span></span> we'll be done."

<div class="paragraph"> </div>

    By contrast, the variant <span class="inlinecode"><span class="id" title="tactic">apply</span>...</span> <span class="inlinecode"><span class="id" title="keyword">in</span>...</span> is "forward reasoning":
    it says "We know <span class="inlinecode"><span class="id" title="variable">Y</span></span> and we know <span class="inlinecode"><span class="id" title="variable">Y</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="variable">X</span></span>, so we also know <span class="inlinecode"><span class="id" title="variable">X</span></span>." 
</div>

<div class="doc">
<a name="lab155"></a><h1 class="section">Varying the Induction Hypothesis</h1>

<div class="paragraph"> </div>

 Recall this function for doubling a natural number (from the
    <a href="Induction.html"><span class="inlineref">Induction</span></a> chapter): 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fixpoint</span> <span class="id" title="variable">double</span> (<span class="id" title="variable">n</span>:<span class="id" title="variable">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">O</span> ⇒ <span class="id" title="variable">O</span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">S</span> <span class="id" title="variable">n'</span> ⇒ <span class="id" title="variable">S</span> (<span class="id" title="variable">S</span> (<span class="id" title="variable">double</span> <span class="id" title="variable">n'</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
<a name="lab156"></a><h3 class="section"> </h3>
 Suppose we want to show that <span class="inlinecode"><span class="id" title="variable">double</span></span> is injective &mdash; i.e.,
    that it maps different arguments to different results.  The
    way we <i>start</i> this proof is a little bit delicate: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">double_injective_FAILED</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">double</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">double</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span> <span class="id" title="variable">IHn'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">intros</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>.<br/>
</div>

<div class="doc">
At this point, the induction hypothesis, <span class="inlinecode"><span class="id" title="variable">IHn'</span></span>, does <i>not</i> give us
    <span class="inlinecode"><span class="id" title="variable">n'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">m'</span></span> &mdash; there is an extra <span class="inlinecode"><span class="id" title="variable">S</span></span> in the way &mdash; so the goal is
    not provable. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a name="lab157"></a><h3 class="section"> </h3>

</div>
<div class="code code-space">

<br/>
</div>

<div class="doc">
The successful proof of <span class="inlinecode"><span class="id" title="variable">double_injective</span></span> leaves <span class="inlinecode"><span class="id" title="variable">m</span></span> in the goal
    statement at the point where the <span class="inlinecode"><span class="id" title="tactic">induction</span></span> tactic is invoked on
    <span class="inlinecode"><span class="id" title="variable">n</span></span>: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">double_injective</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">double</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">double</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span> <span class="id" title="variable">IHn'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">IHn'</span>. <span class="id" title="tactic">injection</span> <span class="id" title="variable">eq</span> <span class="id" title="keyword">as</span> <span class="id" title="variable">goal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">goal</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">eqb_true</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> =? <span class="id" title="variable">m</span> = <span class="id" title="variable">true</span> → <span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORK&nbsp;IN&nbsp;CLASS&nbsp;*)</span> <span class="id" title="variable">Admitted</span>.<br/><hr class='doublespaceincode'/>
</div>

<div class="doc">
<a name="lab159"></a><h3 class="section"> </h3>
 The strategy of doing fewer <span class="inlinecode"><span class="id" title="tactic">intros</span></span> before an <span class="inlinecode"><span class="id" title="tactic">induction</span></span> to
    obtain a more general IH doesn't always work by itself; sometimes
    some <i>rearrangement</i> of quantified variables is needed.  Suppose,
    for example, that we wanted to prove <span class="inlinecode"><span class="id" title="variable">double_injective</span></span> by
    induction on <span class="inlinecode"><span class="id" title="variable">m</span></span> instead of <span class="inlinecode"><span class="id" title="variable">n</span></span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">double_injective_take2_FAILED</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">double</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">double</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span> <span class="id" title="variable">IHm'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span> <span class="id" title="tactic">intros</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Stuck&nbsp;again&nbsp;here,&nbsp;just&nbsp;like&nbsp;before.&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a name="lab160"></a><h3 class="section"> </h3>
 The problem is that, to do induction on <span class="inlinecode"><span class="id" title="variable">m</span></span>, we must first
    introduce <span class="inlinecode"><span class="id" title="variable">n</span></span>.  (If we simply say <span class="inlinecode"><span class="id" title="tactic">induction</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> without
    introducing anything first, Coq will automatically introduce <span class="inlinecode"><span class="id" title="variable">n</span></span>
    for us!)  
</div>

<div class="doc">
<a name="lab161"></a><h3 class="section"> </h3>
 What we can do instead is to first introduce all the quantified
    variables and then <i>re-generalize</i> one or more of them,
    selectively taking variables out of the context and putting them
    back at the beginning of the goal.  The <span class="inlinecode"><span class="id" title="tactic">generalize</span></span> <span class="inlinecode"><span class="id" title="tactic">dependent</span></span>
    tactic does this. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">double_injective_take2</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">double</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">double</span> <span class="id" title="variable">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="variable">n</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="variable">m</span></span>&nbsp;are&nbsp;both&nbsp;in&nbsp;the&nbsp;context&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="variable">n</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Now&nbsp;<span class="inlinecode"><span class="id" title="variable">n</span></span>&nbsp;is&nbsp;back&nbsp;in&nbsp;the&nbsp;goal&nbsp;and&nbsp;we&nbsp;can&nbsp;do&nbsp;induction&nbsp;on<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="variable">m</span></span>&nbsp;and&nbsp;get&nbsp;a&nbsp;sufficiently&nbsp;general&nbsp;IH.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">m</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">m'</span> <span class="id" title="variable">IHm'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;m&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;m&nbsp;=&nbsp;S&nbsp;m'&nbsp;*)</span> <span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="variable">n'</span>] <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;O&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;S&nbsp;n'&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">IHm'</span>. <span class="id" title="tactic">injection</span> <span class="id" title="variable">eq</span> <span class="id" title="keyword">as</span> <span class="id" title="variable">goal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">goal</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
</div>

<div class="doc">
<a name="lab163"></a><h1 class="section">Unfolding Definitions</h1>

<div class="paragraph"> </div>

 It sometimes happens that we need to manually unfold a name that
    has been introduced by a <span class="inlinecode"><span class="id" title="keyword">Definition</span></span> so that we can manipulate
    its right-hand side.  For example, if we define... 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <span class="id" title="variable">square</span> <span class="id" title="variable">n</span> := <span class="id" title="variable">n</span> * <span class="id" title="variable">n</span>.<br/>
</div>

<div class="doc">
... and try to prove a simple fact about <span class="inlinecode"><span class="id" title="variable">square</span></span>... 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">square_mult</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>, <span class="id" title="variable">square</span> (<span class="id" title="variable">n</span> * <span class="id" title="variable">m</span>) = <span class="id" title="variable">square</span> <span class="id" title="variable">n</span> * <span class="id" title="variable">square</span> <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
</div>

<div class="doc">
... we appear to be stuck: <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> doesn't simplify anything at
    this point, and since we haven't proved any other facts about
    <span class="inlinecode"><span class="id" title="variable">square</span></span>, there is nothing we can <span class="inlinecode"><span class="id" title="tactic">apply</span></span> or <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> with.

<div class="paragraph"> </div>

    To make progress, we can manually <span class="inlinecode"><span class="id" title="tactic">unfold</span></span> the definition of
    <span class="inlinecode"><span class="id" title="variable">square</span></span>: 
</div>
<div class="code code-tight">

&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="variable">square</span>.<br/>
</div>

<div class="doc">
Now we have plenty to work with: both sides of the equality are
    expressions involving multiplication, and we have lots of facts
    about multiplication at our disposal.  In particular, we know that
    it is commutative and associative, and from these it is not hard
    to finish the proof. 
</div>
<div class="code code-tight">

&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">mult_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="variable">H</span> : <span class="id" title="variable">n</span> * <span class="id" title="variable">m</span> * <span class="id" title="variable">n</span> = <span class="id" title="variable">n</span> * <span class="id" title="variable">n</span> * <span class="id" title="variable">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">mult_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">mult_assoc</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="variable">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">mult_assoc</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab164"></a><h3 class="section"> </h3>
 At this point, some discussion of unfolding and simplification is
    in order.

<div class="paragraph"> </div>

    You may already have observed that tactics like <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>,
    <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>, and <span class="inlinecode"><span class="id" title="tactic">apply</span></span> will often unfold the definitions of
    functions automatically when this allows them to make progress.
    For example, if we define <span class="inlinecode"><span class="id" title="variable">foo</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> to be the constant <span class="inlinecode">5</span>... 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <span class="id" title="variable">foo</span> (<span class="id" title="variable">x</span>: <span class="id" title="variable">nat</span>) := 5.<br/>
</div>

<div class="doc">
.... then the <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> in the following proof (or the
    <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>, if we omit the <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>) will unfold <span class="inlinecode"><span class="id" title="variable">foo</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> to
    <span class="inlinecode">(<span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="variable">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode">5)</span> <span class="inlinecode"><span class="id" title="variable">m</span></span> and then further simplify this expression to just
    <span class="inlinecode">5</span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fact</span> <span class="id" title="variable">silly_fact_1</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">m</span>, <span class="id" title="variable">foo</span> <span class="id" title="variable">m</span> + 1 = <span class="id" title="variable">foo</span> (<span class="id" title="variable">m</span> + 1) + 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab165"></a><h3 class="section"> </h3>
 However, this automatic unfolding is somewhat conservative.  For
    example, if we define a slightly more complicated function
    involving a pattern match... 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <span class="id" title="variable">bar</span> <span class="id" title="variable">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="variable">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">O</span> ⇒ 5<br/>
&nbsp;&nbsp;| <span class="id" title="variable">S</span> <span class="id" title="variable">_</span> ⇒ 5<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
...then the analogous proof will get stuck: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fact</span> <span class="id" title="variable">silly_fact_2_FAILED</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">m</span>, <span class="id" title="variable">bar</span> <span class="id" title="variable">m</span> + 1 = <span class="id" title="variable">bar</span> (<span class="id" title="variable">m</span> + 1) + 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="comment">(*&nbsp;Does&nbsp;nothing!&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The reason that <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> doesn't make progress here is that it
    notices that, after tentatively unfolding <span class="inlinecode"><span class="id" title="variable">bar</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span>, it is left with
    a match whose scrutinee, <span class="inlinecode"><span class="id" title="variable">m</span></span>, is a variable, so the <span class="inlinecode"><span class="id" title="keyword">match</span></span> cannot
    be simplified further.  It is not smart enough to notice that the
    two branches of the <span class="inlinecode"><span class="id" title="keyword">match</span></span> are identical, so it gives up on
    unfolding <span class="inlinecode"><span class="id" title="variable">bar</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> and leaves it alone.  Similarly, tentatively
    unfolding <span class="inlinecode"><span class="id" title="variable">bar</span></span> <span class="inlinecode">(<span class="id" title="variable">m</span>+1)</span> leaves a <span class="inlinecode"><span class="id" title="keyword">match</span></span> whose scrutinee is a
    function application (that cannot itself be simplified, even
    after unfolding the definition of <span class="inlinecode">+</span>), so <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> leaves it
    alone. 
<div class="paragraph"> </div>

<a name="lab166"></a><h3 class="section"> </h3>
 At this point, there are two ways to make progress.  One is to use
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode"><span class="id" title="variable">m</span></span> to break the proof into two cases, each focusing on a
    more concrete choice of <span class="inlinecode"><span class="id" title="variable">m</span></span> (<span class="inlinecode"><span class="id" title="variable">O</span></span> vs <span class="inlinecode"><span class="id" title="variable">S</span></span> <span class="inlinecode"><span class="id" title="variable">_</span></span>).  In each case, the
    <span class="inlinecode"><span class="id" title="keyword">match</span></span> inside of <span class="inlinecode"><span class="id" title="variable">bar</span></span> can now make progress, and the proof is
    easy to complete. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fact</span> <span class="id" title="variable">silly_fact_2</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">m</span>, <span class="id" title="variable">bar</span> <span class="id" title="variable">m</span> + 1 = <span class="id" title="variable">bar</span> (<span class="id" title="variable">m</span> + 1) + 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
This approach works, but it depends on our recognizing that the
    <span class="inlinecode"><span class="id" title="keyword">match</span></span> hidden inside <span class="inlinecode"><span class="id" title="variable">bar</span></span> is what was preventing us from making
    progress. 
<div class="paragraph"> </div>

<a name="lab167"></a><h3 class="section"> </h3>
 A more straightforward way to make progress is to explicitly tell
    Coq to unfold <span class="inlinecode"><span class="id" title="variable">bar</span></span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fact</span> <span class="id" title="variable">silly_fact_2'</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">m</span>, <span class="id" title="variable">bar</span> <span class="id" title="variable">m</span> + 1 = <span class="id" title="variable">bar</span> (<span class="id" title="variable">m</span> + 1) + 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="variable">bar</span>.<br/>
</div>

<div class="doc">
Now it is apparent that we are stuck on the <span class="inlinecode"><span class="id" title="keyword">match</span></span> expressions on
    both sides of the <span class="inlinecode">=</span>, and we can use <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> to finish the
    proof without thinking too hard. 
</div>
<div class="code code-tight">

&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">m</span> <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab168"></a><h1 class="section">Using <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> on Compound Expressions</h1>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> tactic can be used on expressions as well as
    variables: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <span class="id" title="variable">sillyfun</span> (<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>) : <span class="id" title="variable">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="variable">n</span> =? 3 <span class="id" title="keyword">then</span> <span class="id" title="variable">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="variable">n</span> =? 5 <span class="id" title="keyword">then</span> <span class="id" title="variable">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="variable">false</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">sillyfun_false</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="variable">sillyfun</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">false</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="variable">sillyfun</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="variable">n</span> =? 3) <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;3&nbsp;=&nbsp;true&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;3&nbsp;=&nbsp;false&nbsp;*)</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="variable">n</span> =? 5) <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;5&nbsp;=&nbsp;true&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;5&nbsp;=&nbsp;false&nbsp;*)</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab169"></a><h3 class="section"> </h3>
 The <span class="inlinecode"><span class="id" title="variable">eqn</span>:</span> part of the <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> tactic is optional: We've chosen
    to include it most of the time, just for the sake of
    documentation, but many Coq proofs omit it.

<div class="paragraph"> </div>

    When <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>ing compound expressions, however, the information
    recorded by the <span class="inlinecode"><span class="id" title="variable">eqn</span>:</span> can actually be critical: if we leave it
    out, then <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> can sometimes erase information we need to
    complete a proof. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Definition</span> <span class="id" title="variable">sillyfun1</span> (<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>) : <span class="id" title="variable">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="variable">n</span> =? 3 <span class="id" title="keyword">then</span> <span class="id" title="variable">true</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="variable">n</span> =? 5 <span class="id" title="keyword">then</span> <span class="id" title="variable">true</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="variable">false</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">sillyfun1_odd_FAILED</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">sillyfun1</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">oddb</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="variable">sillyfun1</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="variable">n</span> =? 3).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;stuck...&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a name="lab170"></a><h3 class="section"> </h3>
 Adding the <span class="inlinecode"><span class="id" title="variable">eqn</span>:</span> qualifier saves this information so we
    can use it. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">sillyfun1_odd</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span> : <span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">sillyfun1</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">oddb</span> <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">n</span> <span class="id" title="variable">eq</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="variable">sillyfun1</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="variable">n</span> =? 3) <span class="id" title="variable">eqn</span>:<span class="id" title="variable">Heqe3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;e<sub>3</sub>&nbsp;=&nbsp;true&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">eqb_true</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">Heqe3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">Heqe3</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;e<sub>3</sub>&nbsp;=&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="variable">n</span> =? 5) <span class="id" title="variable">eqn</span>:<span class="id" title="variable">Heqe5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;e<sub>5</sub>&nbsp;=&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">eqb_true</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">Heqe5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → <span class="id" title="variable">Heqe5</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;e<sub>5</sub>&nbsp;=&nbsp;false&nbsp;*)</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="variable">eq</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab171"></a><h1 class="section">Micro Sermon</h1>

<div class="paragraph"> </div>

 Mindless proof-hacking is a terrible temptation...

<div class="paragraph"> </div>

    Try to resist!

</div>
</div>



</div>

</body>
</html>