<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>AltAuto: More Automation</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="common/slides.js"></script>
<link href="common/css/slides.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 1: Logical Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">AltAuto<span class="subtitle">More Automation</span></h1>


<div class="code code-tight">

<span class="id" title="keyword">Set</span> <span class="id" title="variable">Warnings</span> "-notation-overridden,-parsing".<br/>
<span class="id" title="variable">From</span> <span class="id" title="variable">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="variable">omega.Omega</span>.<br/>
<span class="id" title="variable">From</span> <span class="id" title="variable">LF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="variable">IndProp</span>.<br/>
</div>

<div class="doc">
Here's a function that rewrites regular expressions into
    potentially simpler forms without changing their matching
    behavior. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Fixpoint</span> <span class="id" title="variable">re_opt_e</span> {<span class="id" title="variable">T</span>:<span class="id" title="keyword">Type</span>} (<span class="id" title="variable">re</span>: <span class="id" title="variable">reg_exp</span> <span class="id" title="variable">T</span>) : <span class="id" title="variable">reg_exp</span> <span class="id" title="variable">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="variable">re</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">App</span> <span class="id" title="variable">EmptyStr</span> <span class="id" title="variable">re<sub>2</sub></span> ⇒ <span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="variable">App</span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">re<sub>2</sub></span> ⇒ <span class="id" title="variable">App</span> (<span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re<sub>1</sub></span>) (<span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <span class="id" title="variable">Union</span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">re<sub>2</sub></span> ⇒ <span class="id" title="variable">Union</span> (<span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re<sub>1</sub></span>) (<span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <span class="id" title="variable">Star</span> <span class="id" title="variable">re</span> ⇒ <span class="id" title="variable">Star</span> (<span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="variable">_</span> ⇒ <span class="id" title="variable">re</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
We would like to show the equivalence of re's with their "optimized" form.
One direction of this equivalence looks like this (the other is similar).

</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">re_opt_e_match</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">T</span> (<span class="id" title="variable">re</span>: <span class="id" title="variable">reg_exp</span> <span class="id" title="variable">T</span>) <span class="id" title="variable">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">s</span> =~ <span class="id" title="variable">re</span> → <span class="id" title="variable">s</span> =~ <span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">T</span> <span class="id" title="variable">re</span> <span class="id" title="variable">s</span> <span class="id" title="variable">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [| <span class="id" title="variable">x'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch1</span> <span class="id" title="variable">IH<sub>1</sub></span> <span class="id" title="variable">Hmatch2</span> <span class="id" title="variable">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch</span> <span class="id" title="variable">IH</span> | <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch</span> <span class="id" title="variable">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">re</span> | <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re</span> <span class="id" title="variable">Hmatch1</span> <span class="id" title="variable">IH<sub>1</sub></span> <span class="id" title="variable">Hmatch2</span> <span class="id" title="variable">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MEmpty</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MChar</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span> <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">re<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="variable">Hmatch1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MUnionL</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MUnionR</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MStar0</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">MStarApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab454"></a><h1 class="section">Coq Automation</h1>

<div class="paragraph"> </div>

 That last proof was getting a little repetitive.  Time to
    learn a few more Coq tricks... 
</div>

<div class="doc">
<a name="lab455"></a><h1 class="section">Tacticals</h1>

<div class="paragraph"> </div>

 <i>Tacticals</i> is Coq's term for tactics that take other tactics as
    arguments &mdash; "higher-order tactics," if you will.  
</div>

<div class="doc">
<a name="lab456"></a><h3 class="section">The <span class="inlinecode"><span class="id" title="tactic">try</span></span> Tactical</h3>

<div class="paragraph"> </div>

 If <span class="inlinecode"><span class="id" title="variable">T</span></span> is a tactic, then <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="variable">T</span></span> is a tactic that is just like <span class="inlinecode"><span class="id" title="variable">T</span></span>
    except that, if <span class="inlinecode"><span class="id" title="variable">T</span></span> fails, <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="variable">T</span></span> <i>successfully</i> does nothing at
    all (instead of failing). 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">silly2</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="variable">P</span> → <span class="id" title="variable">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">P</span> <span class="id" title="variable">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="comment">(*&nbsp;just&nbsp;<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>&nbsp;would&nbsp;have&nbsp;failed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">HP</span>. <span class="comment">(*&nbsp;we&nbsp;can&nbsp;still&nbsp;finish&nbsp;the&nbsp;proof&nbsp;in&nbsp;some&nbsp;other&nbsp;way&nbsp;*)</span><br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab457"></a><h3 class="section">The <span class="inlinecode">;</span> Tactical (Simple Form)</h3>

<div class="paragraph"> </div>

 In its most common form, the <span class="inlinecode">;</span> tactical takes two tactics as
    arguments.  The compound tactic <span class="inlinecode"><span class="id" title="variable">T</span>;<span class="id" title="variable">T'</span></span> first performs <span class="inlinecode"><span class="id" title="variable">T</span></span> and then
    performs <span class="inlinecode"><span class="id" title="variable">T'</span></span> on <i>each subgoal</i> generated by <span class="inlinecode"><span class="id" title="variable">T</span></span>. 
<div class="paragraph"> </div>

 For example: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">foo</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span>, 0 &lt;=? <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span> <span class="id" title="variable">eqn</span>:<span class="id" title="variable">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Leaves&nbsp;two&nbsp;subgoals,&nbsp;which&nbsp;are&nbsp;discharged&nbsp;identically...&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n=0&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n=Sn'&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab458"></a><h3 class="section"> </h3>
 We can simplify this proof using the <span class="inlinecode">;</span> tactical: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">foo'</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span>, 0 &lt;=? <span class="id" title="variable">n</span> = <span class="id" title="variable">true</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>&nbsp;the&nbsp;current&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">n</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;then&nbsp;<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>&nbsp;each&nbsp;resulting&nbsp;subgoal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;do&nbsp;<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>&nbsp;on&nbsp;each&nbsp;resulting&nbsp;subgoal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab459"></a><h3 class="section"> </h3>
 Using <span class="inlinecode"><span class="id" title="tactic">try</span></span> and <span class="inlinecode">;</span> together, we can get rid of the repetition in
    the proof that was bothering us a little while ago. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">re_opt_e_match'</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">T</span> (<span class="id" title="variable">re</span>: <span class="id" title="variable">reg_exp</span> <span class="id" title="variable">T</span>) <span class="id" title="variable">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">s</span> =~ <span class="id" title="variable">re</span> → <span class="id" title="variable">s</span> =~ <span class="id" title="variable">re_opt_e</span> <span class="id" title="variable">re</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">T</span> <span class="id" title="variable">re</span> <span class="id" title="variable">s</span> <span class="id" title="variable">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [| <span class="id" title="variable">x'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch1</span> <span class="id" title="variable">IH<sub>1</sub></span> <span class="id" title="variable">Hmatch2</span> <span class="id" title="variable">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch</span> <span class="id" title="variable">IH</span> | <span class="id" title="variable">re<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re<sub>2</sub></span> <span class="id" title="variable">Hmatch</span> <span class="id" title="variable">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="variable">re</span> | <span class="id" title="variable">s<sub>1</sub></span> <span class="id" title="variable">s<sub>2</sub></span> <span class="id" title="variable">re</span> <span class="id" title="variable">Hmatch1</span> <span class="id" title="variable">IH<sub>1</sub></span> <span class="id" title="variable">Hmatch2</span> <span class="id" title="variable">IH<sub>2</sub></span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Do&nbsp;the&nbsp;<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>&nbsp;for&nbsp;every&nbsp;case&nbsp;here:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">MEmpty</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">MChar</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="variable">re<sub>1</sub></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Most&nbsp;cases&nbsp;follow&nbsp;by&nbsp;the&nbsp;same&nbsp;formula.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="variable">MApp</span></span>&nbsp;gives&nbsp;two&nbsp;subgoals:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="variable">H<sub>1</sub></span></span>&nbsp;is&nbsp;run&nbsp;on&nbsp;both&nbsp;of&nbsp;them&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;succeeds&nbsp;on&nbsp;the&nbsp;first&nbsp;but&nbsp;not&nbsp;the&nbsp;second;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="variable">H<sub>2</sub></span></span>&nbsp;is&nbsp;then&nbsp;run&nbsp;on&nbsp;this&nbsp;remaining&nbsp;goal.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="variable">MApp</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>; <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;interesting&nbsp;case,&nbsp;on&nbsp;which&nbsp;<span class="inlinecode"><span class="id" title="tactic">try</span>...</span>&nbsp;does&nbsp;nothing,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;when&nbsp;<span class="inlinecode"><span class="id" title="variable">re<sub>1</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">EmptyStr</span></span>.&nbsp;In&nbsp;this&nbsp;case,&nbsp;we&nbsp;have<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;appeal&nbsp;to&nbsp;the&nbsp;fact&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="variable">re<sub>1</sub></span></span>&nbsp;matches&nbsp;only&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;empty&nbsp;string:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="variable">Hmatch1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">MUnionL</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">MUnionR</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="variable">MStar0</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span>  <span class="id" title="tactic">apply</span> <span class="id" title="variable">MStarApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">IH<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab460"></a><h3 class="section">The <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> Tactical</h3>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> tactical takes another tactic and keeps applying this
    tactic until it fails. Here is an example showing that <span class="inlinecode">10</span> is in
    a long list using repeat. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Theorem</span> <span class="id" title="variable">In<sub>10</sub></span> : <span class="id" title="variable">In</span> 10 [1;2;3;4;5;6;7;8;9;10].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> (<span class="id" title="variable">left</span>; <span class="id" title="tactic">reflexivity</span>); <span class="id" title="variable">right</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab461"></a><h2 class="section">A Few More Handy Tactics</h2>

<div class="paragraph"> </div>

 By the way, here are some miscellaneous tactics that you may find
    convenient as we continue.

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">clear</span></span> <span class="inlinecode"><span class="id" title="variable">H</span></span>: Delete hypothesis <span class="inlinecode"><span class="id" title="variable">H</span></span> from the context.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">rename</span>...</span> <span class="inlinecode"><span class="id" title="variable">into</span>...</span>: Change the name of a hypothesis in the
       proof context.  For example, if the context includes a variable
       named <span class="inlinecode"><span class="id" title="variable">x</span></span>, then <span class="inlinecode"><span class="id" title="tactic">rename</span></span> <span class="inlinecode"><span class="id" title="variable">x</span></span> <span class="inlinecode"><span class="id" title="variable">into</span></span> <span class="inlinecode"><span class="id" title="variable">y</span></span> will change all occurrences
       of <span class="inlinecode"><span class="id" title="variable">x</span></span> to <span class="inlinecode"><span class="id" title="variable">y</span></span>.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="variable">x</span></span>: Find an assumption <span class="inlinecode"><span class="id" title="variable">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">e</span></span> or <span class="inlinecode"><span class="id" title="variable">e</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">x</span></span> in the
       context, replace <span class="inlinecode"><span class="id" title="variable">x</span></span> with <span class="inlinecode"><span class="id" title="variable">e</span></span> throughout the context and
       current goal, and clear the assumption.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">subst</span></span>: Substitute away <i>all</i> assumptions of the form <span class="inlinecode"><span class="id" title="variable">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">e</span></span>
       or <span class="inlinecode"><span class="id" title="variable">e</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="variable">x</span></span>.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

    We'll see examples as we go along. 
</div>

<div class="doc">
<a name="lab462"></a><h2 class="section">Defining New Tactics</h2>

<div class="paragraph"> </div>

 Coq also provides several ways of "programming" tactic scripts:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="keyword">Ltac</span></span>: scripting language for tactics (good for more
       sophisticated proof engineering)

</li>
<li> OCaml tactic scripting API (only for wizards).

</li>
</ul>

<div class="paragraph"> </div>

    Here is a simple <span class="inlinecode"><span class="id" title="keyword">Ltac</span></span> example: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Ltac</span> <span class="id" title="variable">impl_and_try</span> <span class="id" title="variable">c</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="variable">c</span>.<br/>
</div>

<div class="doc">
<a name="lab463"></a><h1 class="section">Decision Procedures</h1>

<div class="paragraph"> </div>

<a name="lab464"></a><h2 class="section">The Omega Tactic</h2>

</div>
<div class="code code-space">

<br/>
<span class="id" title="keyword">Example</span> <span class="id" title="variable">silly_presburger_example</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">m</span> <span class="id" title="variable">n</span> <span class="id" title="variable">o</span> <span class="id" title="variable">p</span>,<br/>
&nbsp;&nbsp;<span class="id" title="variable">m</span> + <span class="id" title="variable">n</span> ≤ <span class="id" title="variable">n</span> + <span class="id" title="variable">o</span> ∧ <span class="id" title="variable">o</span> + 3 = <span class="id" title="variable">p</span> + 3 →<br/>
&nbsp;&nbsp;<span class="id" title="variable">m</span> ≤ <span class="id" title="variable">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab465"></a><h1 class="section">Search Tactics</h1>

<div class="paragraph"> </div>

<a name="lab466"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="variable">constructor</span></span> tactic.</h2>

<div class="paragraph"> </div>

 A simple first example of a search tactic is <span class="inlinecode"><span class="id" title="variable">constructor</span></span>,
    which tries to find a constructor <span class="inlinecode"><span class="id" title="variable">c</span></span> (from some
    <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> definition in the current environment) that can be
    applied to solve the current goal.  If one is found, behave
    like <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="variable">c</span></span>. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">constructor_example</span>: <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">n</span>:<span class="id" title="variable">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">even</span> (<span class="id" title="variable">n</span>+<span class="id" title="variable">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="variable">n</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="variable">constructor</span>. <span class="comment">(*&nbsp;applies&nbsp;ev_0&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">plus_comm</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="variable">constructor</span>. <span class="comment">(*&nbsp;applies&nbsp;ev_SS&nbsp;*)</span> <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
This saves us from needing to remember the names of our constructors.
    Warning: if more than one constructor can apply, <span class="inlinecode"><span class="id" title="variable">constructor</span></span> picks
    the first one (in the order in which they were defined in the <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>)
    which is not necessarily the one we want! 
<div class="paragraph"> </div>

<a name="lab467"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> Tactic</h2>

<div class="paragraph"> </div>

 Thus far, our proof scripts mostly apply relevant hypotheses or
    lemmas by name, and one at a time. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_1</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="variable">P</span> → <span class="id" title="variable">Q</span>) → (<span class="id" title="variable">Q</span> → <span class="id" title="variable">R</span>) → <span class="id" title="variable">P</span> → <span class="id" title="variable">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span> <span class="id" title="variable">H<sub>1</sub></span> <span class="id" title="variable">H<sub>2</sub></span> <span class="id" title="variable">H<sub>3</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>1</sub></span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic frees us from this drudgery by <i>searching</i> for a
    sequence of applications that will prove the goal: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_1'</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="variable">P</span> → <span class="id" title="variable">Q</span>) → (<span class="id" title="variable">Q</span> → <span class="id" title="variable">R</span>) → <span class="id" title="variable">P</span> → <span class="id" title="variable">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab468"></a><h3 class="section"> </h3>
 The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic solves goals that are solvable by any combination of

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">intros</span></span> and

</li>
<li> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> (of hypotheses from the local context, by default). 
</li>
</ul>

<div class="paragraph"> </div>

 Here is a more interesting example showing <span class="inlinecode"><span class="id" title="tactic">auto</span></span>'s power: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_2</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span> <span class="id" title="variable">S</span> <span class="id" title="variable">T</span> <span class="id" title="variable">U</span> : <span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="variable">P</span> → <span class="id" title="variable">Q</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">P</span> → <span class="id" title="variable">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">T</span> → <span class="id" title="variable">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">S</span> → <span class="id" title="variable">T</span> → <span class="id" title="variable">U</span>) →<br/>
&nbsp;&nbsp;((<span class="id" title="variable">P</span>→<span class="id" title="variable">Q</span>) → (<span class="id" title="variable">P</span>→<span class="id" title="variable">S</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="variable">T</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">U</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab469"></a><h3 class="section"> </h3>
 Proof search could, in principle, take an arbitrarily long time,
    so there are limits to how far <span class="inlinecode"><span class="id" title="tactic">auto</span></span> will search by default. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_3</span> : <span style='font-size:120%;'>&forall;</span>(<span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span> <span class="id" title="variable">S</span> <span class="id" title="variable">T</span> <span class="id" title="variable">U</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="variable">P</span> → <span class="id" title="variable">Q</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">Q</span> → <span class="id" title="variable">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">R</span> → <span class="id" title="variable">S</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">S</span> → <span class="id" title="variable">T</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">T</span> → <span class="id" title="variable">U</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="variable">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">U</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;When&nbsp;it&nbsp;cannot&nbsp;solve&nbsp;the&nbsp;goal,&nbsp;<span class="inlinecode"><span class="id" title="tactic">auto</span></span>&nbsp;does&nbsp;nothing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Optional&nbsp;argument&nbsp;says&nbsp;how&nbsp;deep&nbsp;to&nbsp;search&nbsp;(default&nbsp;is&nbsp;5)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> 6.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab470"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="tactic">auto</span></span> considers the hypotheses in the current context
    together with a <i>hint database</i> of other lemmas and constructors.
    Some common facts about equality and logical operators are
    installed in the hint database by default. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_4</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">P</span> <span class="id" title="variable">Q</span> <span class="id" title="variable">R</span> : <span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;<span class="id" title="variable">Q</span> →<br/>
&nbsp;&nbsp;(<span class="id" title="variable">Q</span> → <span class="id" title="variable">R</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="variable">P</span> ∨ (<span class="id" title="variable">Q</span> ∧ <span class="id" title="variable">R</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
If we want to see which facts <span class="inlinecode"><span class="id" title="tactic">auto</span></span> is using, we can use
    <span class="inlinecode"><span class="id" title="variable">info_auto</span></span> instead. 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_5</span>: 2 = 2.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;auto&nbsp;subsumes&nbsp;reflexivity&nbsp;because&nbsp;eq_refl&nbsp;is&nbsp;in&nbsp;hint&nbsp;database&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="variable">info_auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab471"></a><h3 class="section"> </h3>
 We can extend the hint database just for the purposes of one
    application of <span class="inlinecode"><span class="id" title="tactic">auto</span></span> by writing "<span class="inlinecode"><span class="id" title="tactic">auto</span></span> <span class="inlinecode"><span class="id" title="keyword">using</span></span> <span class="inlinecode">...</span>". 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Lemma</span> <span class="id" title="variable">le_antisym</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span>: <span class="id" title="variable">nat</span>, (<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">m</span> ∧ <span class="id" title="variable">m</span> ≤ <span class="id" title="variable">n</span>) → <span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_6</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">p</span> : <span class="id" title="variable">nat</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">p</span> → (<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">m</span> ∧ <span class="id" title="variable">m</span> ≤ <span class="id" title="variable">n</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <span class="id" title="variable">le_antisym</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab472"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 We can also permanently extend the hint database:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> <span class="inlinecode"><span class="id" title="variable">T</span>.</span>

<div class="paragraph"> </div>

          Add theorem or constructor <span class="inlinecode"><span class="id" title="variable">T</span></span> to the global DB

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="variable">Constructors</span></span> <span class="inlinecode"><span class="id" title="variable">c</span>.</span>

<div class="paragraph"> </div>

          Add <i>all</i> constructors of <span class="inlinecode"><span class="id" title="variable">c</span></span> to the global DB

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Unfold</span></span> <span class="inlinecode"><span class="id" title="variable">d</span>.</span>

<div class="paragraph"> </div>

          Automatically expand defined symbol <span class="inlinecode"><span class="id" title="variable">d</span></span> during <span class="inlinecode"><span class="id" title="tactic">auto</span></span>

</li>
</ul>

<div class="paragraph"> </div>

 It is also possible to define specialized hint databases that can
    be activated only when needed.  See the Coq reference manual for
    more. 
<div class="paragraph"> </div>

<a name="lab473"></a><h3 class="section"> </h3>

</div>
<div class="code code-space">
<span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Resolve</span> <span class="id" title="variable">le_antisym</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_6'</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">n</span> <span class="id" title="variable">m</span> <span class="id" title="variable">p</span> : <span class="id" title="variable">nat</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="variable">n</span>≤ <span class="id" title="variable">p</span> → (<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">m</span> ∧ <span class="id" title="variable">m</span> ≤ <span class="id" title="variable">n</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> ≤ <span class="id" title="variable">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="variable">n</span> = <span class="id" title="variable">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="comment">(*&nbsp;picks&nbsp;up&nbsp;hint&nbsp;from&nbsp;database&nbsp;*)</span><br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab474"></a><h3 class="section"> </h3>

</div>
<div class="code code-space">
<span class="id" title="keyword">Definition</span> <span class="id" title="variable">is_fortytwo</span> <span class="id" title="variable">x</span> := (<span class="id" title="variable">x</span> = 42).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_7</span>: <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">x</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="variable">x</span> ≤ 42 ∧ 42 ≤ <span class="id" title="variable">x</span>) → <span class="id" title="variable">is_fortytwo</span> <span class="id" title="variable">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="comment">(*&nbsp;does&nbsp;nothing&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Unfold</span> <span class="id" title="variable">is_fortytwo</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="variable">auto_example_7'</span> : <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">x</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="variable">x</span> ≤ 42 ∧ 42 ≤ <span class="id" title="variable">x</span>) → <span class="id" title="variable">is_fortytwo</span> <span class="id" title="variable">x</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="variable">info_auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab475"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">eapply</span></span> and <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> variants</h2>

<div class="paragraph"> </div>

 Consider this example: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">trans_example1</span>:  <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">b</span> + <span class="id" title="variable">b</span>*<span class="id" title="variable">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1+<span class="id" title="variable">c</span>)*<span class="id" title="variable">b</span> ≤ <span class="id" title="variable">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">H<sub>1</sub></span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="variable">le_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="variable">b</span>+ <span class="id" title="variable">b</span>*<span class="id" title="variable">c</span>). <span class="comment">(*&nbsp;&lt;--&nbsp;We&nbsp;must&nbsp;supply&nbsp;the&nbsp;intermediate&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">H<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">mult_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
If we leave out the <span class="inlinecode"><span class="id" title="keyword">with</span></span>, this step fails, because Coq cannot
    find an instance for the variable <span class="inlinecode"><span class="id" title="variable">n</span></span>. But this is silly! The appropriate
    value for <span class="inlinecode"><span class="id" title="variable">n</span></span> will become obvious in the very next step. 
<div class="paragraph"> </div>

<a name="lab476"></a><h3 class="section"> </h3>
 With <span class="inlinecode"><span class="id" title="tactic">eapply</span></span>, we can eliminate this silliness: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">trans_example1'</span>:  <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">b</span> + <span class="id" title="variable">b</span>*<span class="id" title="variable">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1+<span class="id" title="variable">c</span>)*<span class="id" title="variable">b</span> ≤ <span class="id" title="variable">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">H<sub>1</sub></span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="variable">le_trans</span>. <span class="comment">(*&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>1</sub></span>. <span class="comment">(*&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="variable">H<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="variable">mult_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab477"></a><h3 class="section"> </h3>
 Several of the tactics that we've seen so far, including <span class="inlinecode"><span style='font-size:120%;'>&exist;</span></span>,
    <span class="inlinecode"><span class="id" title="variable">constructor</span></span>, and <span class="inlinecode"><span class="id" title="tactic">auto</span></span>, have <span class="inlinecode"><span class="id" title="variable">e</span>...</span> variants.  For example,
    here's a proof using <span class="inlinecode"><span class="id" title="tactic">eauto</span></span>: 
</div>
<div class="code code-tight">

<span class="id" title="keyword">Example</span> <span class="id" title="variable">trans_example2</span>:  <span style='font-size:120%;'>&forall;</span><span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">b</span> + <span class="id" title="variable">b</span>*<span class="id" title="variable">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">b</span> + <span class="id" title="variable">b</span>*<span class="id" title="variable">c</span> ≤ <span class="id" title="variable">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="variable">a</span> ≤ <span class="id" title="variable">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="variable">a</span> <span class="id" title="variable">b</span> <span class="id" title="variable">c</span> <span class="id" title="variable">d</span> <span class="id" title="variable">H<sub>1</sub></span> <span class="id" title="variable">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="variable">info_eauto</span> <span class="id" title="keyword">using</span> <span class="id" title="variable">le_trans</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> tactic works just like <span class="inlinecode"><span class="id" title="tactic">auto</span></span>, except that it uses
    <span class="inlinecode"><span class="id" title="tactic">eapply</span></span> instead of <span class="inlinecode"><span class="id" title="tactic">apply</span></span>.

<div class="paragraph"> </div>

    Pro tip: One might think that, since <span class="inlinecode"><span class="id" title="tactic">eapply</span></span> and <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> are more
    powerful than <span class="inlinecode"><span class="id" title="tactic">apply</span></span> and <span class="inlinecode"><span class="id" title="tactic">auto</span></span>, it would be a good idea to use
    them all the time.  Unfortunately, they are also significantly
    slower &mdash; especially <span class="inlinecode"><span class="id" title="tactic">eauto</span></span>.  Coq experts tend to use <span class="inlinecode"><span class="id" title="tactic">apply</span></span> and
    <span class="inlinecode"><span class="id" title="tactic">auto</span></span> most of the time, only switching to the <span class="inlinecode"><span class="id" title="variable">e</span></span> variants when
    the ordinary variants don't do the job. 
</div>
</div>



</div>

</body>
</html>